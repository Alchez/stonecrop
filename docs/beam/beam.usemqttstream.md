<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [@stonecrop/beam](./beam.md) &gt; [useMqttStream](./beam.usemqttstream.md)

## useMqttStream variable

> This API is provided as a beta preview for developers and may change based on feedback that we receive. Do not use this API in a production environment.
> 

Use MQTT stream

**Signature:**

```typescript
useMqttStream = (options?: IMqttStream) => {
	const client = ref<MqttClient>(null)
	const messages = ref<Record<string, string[]>>({})

	onMounted(() => {
		client.value = mqtt.connect(options)

		if (!options.topics) {
			options.topics = ['#']
		}

		for (const topic of options.topics) {
			client.value.subscribe(topic, err => {
				if (err) {
					throw err
				}
			})
		}

		client.value.on('message', (topic, message) => {
			if (!messages.value[topic]) {
				messages.value[topic] = []
			}

			messages.value[topic].push(message.toString())
		})
	})

	onUnmounted(() => {
		client.value.end()
	})

	return { messages }
}
```
